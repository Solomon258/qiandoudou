# 钱包社交功能测试指南

## 测试环境准备

### 1. 启动后端服务
```bash
cd qiandoudou-backend
mvn spring-boot:run
```
等待服务启动完成，看到类似信息：
```
Started QiandoudouApplication in X.XXX seconds
```

### 2. 启动前端开发
在微信开发者工具中打开 `qiandoudou-frontend` 项目

## 功能测试步骤

### 测试1：自己钱包功能（完整模式）
1. 登录系统
2. 在首页点击钱包卡片
3. **预期结果**：
   - 进入 `wallet-detail` 页面
   - 显示转入/转出按钮
   - 显示超级玛丽推广卡片
   - 显示统计和过滤功能
   - 不显示关注按钮
   - 账单没有点赞评论按钮

### 测试2：他人钱包功能（社交模式）
1. 切换到"兜圈圈"标签页
2. 点击任意他人钱包卡片
3. **预期结果**：
   - 进入 `wallet-detail` 页面（同一个文件）
   - ✅ **隐藏**转入/转出按钮
   - ✅ **隐藏**超级玛丽推广卡片
   - ✅ **显示**社交统计数据（粉丝、获赞、浏览）
   - ✅ **显示**关注按钮（在统计区域右下角）
   - ✅ **隐藏**统计和过滤功能
   - ✅ **显示**账单点赞评论按钮

### 测试3：社交互动功能
在他人钱包页面测试：

#### 关注功能
1. 点击"关注"按钮
2. **预期结果**：
   - 按钮文字变为"已关注"
   - 粉丝数+1
   - 显示"关注成功"提示

#### 点赞功能
1. 点击账单下的心形按钮
2. **预期结果**：
   - 心形变红（🤍 → ❤️）
   - 点赞数+1
   - 显示"已点赞"提示

#### 评论功能
1. 点击账单下的评论按钮
2. 在弹出框中输入评论
3. 点击发送
4. **预期结果**：
   - 评论成功提示
   - 评论数+1
   - 评论显示在账单下方

## 错误处理测试

### API不可用时的降级处理
如果后端服务未启动或API返回404：

1. **关注功能**：仍然显示成功提示，使用模拟模式
2. **点赞功能**：仍然显示成功提示，使用模拟模式
3. **评论功能**：使用模拟发送，延迟500ms显示成功
4. **统计数据**：基于钱包余额计算显示

## 数据来源验证

### 社交统计数据计算公式
- **粉丝数**：`Math.max(Math.floor(余额/100), 1)`
- **获赞数**：`Math.max(Math.floor(余额/50) + 12, 12)`
- **浏览数**：`Math.max(Math.floor(余额/25) + 123, 123)`

### 示例计算
- 余额 ¥31123.12
- 粉丝数：Math.floor(31123.12/100) = 311
- 获赞数：Math.floor(31123.12/50) + 12 = 622 + 12 = 634
- 浏览数：Math.floor(31123.12/25) + 123 = 1244 + 123 = 1367

## 常见问题解决

### 1. 404错误
**原因**：后端服务未启动或新的API接口未加载
**解决**：
- 重启后端服务：`mvn spring-boot:run`
- 检查控制台是否有编译错误
- 确认SocialController已正确加载

### 2. 社交统计不显示
**原因**：可能是数据加载时机问题
**解决**：
- 检查 `fromSocial` 参数是否正确传递
- 查看控制台日志确认数据加载流程

### 3. 关注按钮不显示
**原因**：显示条件不满足
**检查**：
- `fromSocial` 必须为 `true`
- `isOwnWallet` 必须为 `false`

## 成功标准

✅ 所有测试都通过
✅ 页面根据来源智能适配功能
✅ 社交互动功能正常工作
✅ 错误处理机制有效
✅ 数据显示符合图片要求

## 调试技巧

1. **查看控制台日志**：确认参数传递和数据加载
2. **检查网络请求**：在开发者工具网络面板查看API调用
3. **验证数据绑定**：确认 `{{}}` 表达式正确显示数据
4. **测试降级模式**：关闭后端服务测试前端降级处理

---

现在您可以按照这个指南进行测试。如果遇到任何问题，请告诉我具体的错误信息，我会帮您解决。