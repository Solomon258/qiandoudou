# 钱包页面架构说明

## 统一页面设计

根据用户反馈，我们采用了统一的页面设计方案，使用同一个 `wallet-detail` 页面来处理不同的使用场景：

### `wallet-detail` - 智能适配的钱包页面
**文件位置**: `pages/wallet-detail/wallet-detail`

**使用场景**:
1. 用户点击**自己的钱包**时跳转（完整功能模式）
2. 从**兜圈圈**点击他人钱包时跳转（社交展示模式）

**智能功能适配**:

#### 自己的钱包模式 (`fromSocial=false`)
- ✅ 查看钱包详情和余额
- ✅ 转入/转出资金操作按钮
- ✅ 更换钱包背景
- ✅ 修改钱包名称
- ✅ 查看交易记录
- ✅ 剧本攒钱功能
- ✅ 超级玛丽推广卡片
- ✅ 统计和过滤功能
- ✅ 与AI伴侣聊天（情侣钱包）

#### 他人钱包模式 (`fromSocial=true`)
- ✅ 查看钱包基本信息
- ✅ 显示社交统计（粉丝、获赞、浏览）
- ✅ 关注/取消关注功能
- ✅ 查看账单流水
- ✅ 对账单进行点赞和评论
- ❌ 隐藏转入/转出按钮
- ❌ 隐藏推广卡片
- ❌ 隐藏统计和过滤功能
- ❌ 只读模式（无法修改钱包）

## 跳转逻辑

### 用户点击自己的钱包
```javascript
// 在 home.js 中
handleWalletTap(e) {
  const walletId = e.currentTarget.dataset.id
  // 跳转到钱包详情页（完整功能模式）
  wx.navigateTo({
    url: `/pages/wallet-detail/wallet-detail?id=${walletId}`
  })
}
```

### 从兜圈圈点击他人钱包
```javascript
// 在 home.js 中
goToWalletDetail(e) {
  const walletId = e.currentTarget.dataset.walletId
  // 跳转到同一个页面，但传递社交参数
  let url = `/pages/wallet-detail/wallet-detail?id=${walletId}&fromSocial=true`
  // 传递社交信息参数...
  wx.navigateTo({ url })
}
```

## 功能对比

| 功能特性 | 自己钱包模式 | 他人钱包模式 |
|---------|-------------|-------------|
| 查看钱包信息 | ✅ | ✅ |
| 转入/转出 | ✅ | ❌ |
| 更换背景 | ✅ | ❌ |
| 修改名称 | ✅ | ❌ |
| 社交统计 | ✅ | ✅ |
| 关注功能 | ❌ | ✅ |
| 账单点赞 | ❌ | ✅ |
| 账单评论 | ❌ | ✅ |
| 剧本攒钱 | ✅ | ❌ |
| AI聊天 | ✅ | ❌ |
| 推广卡片 | ✅ | ❌ |
| 统计过滤 | ✅ | ❌ |

## 设计优势

### 1. 统一管理
- 使用同一个页面文件，减少代码重复
- 通过参数控制显示不同功能
- 便于维护和更新

### 2. 安全性
- 自己的钱包：完全控制权限
- 他人钱包：只读+社交互动
- 通过 `isOwnWallet` 和 `fromSocial` 参数控制权限

### 3. 用户体验
- 智能适配不同使用场景
- 提供即时UI反馈
- 避免功能混乱和误操作

### 4. 功能完整性
- 社交功能完全集成到钱包页面
- 支持点赞、评论、关注等完整社交互动
- 统计数据基于真实钱包数据计算

## 参数传递

### 自己钱包模式
```
?id=钱包ID
```

### 他人钱包模式（来自兜圈圈）
```
?id=钱包ID&fromSocial=true&ownerNickname=用户昵称&title=钱包标题&fansCount=粉丝数&likeCount=获赞数
```

## 实现的修改

根据您的要求，我已完成以下修改：

1. ✅ **去掉超级玛丽推广卡片**：只在自己钱包时显示
2. ✅ **添加社交统计数据**：显示粉丝、获赞、浏览数量
3. ✅ **添加关注功能**：在统计区域右下角显示关注按钮
4. ✅ **去掉统计和过滤功能**：来自社交圈时隐藏这些功能
5. ✅ **账单点赞评论**：来自社交圈时显示社交互动按钮

## 总结

现在的设计更加合理：

1. **用户点击自己的钱包** → `wallet-detail`（完整功能模式）
2. **兜圈圈点击他人钱包** → `wallet-detail`（社交展示模式）

使用同一个页面文件，但根据参数智能显示不同功能，既保证了功能完整性，又提供了良好的社交体验。
