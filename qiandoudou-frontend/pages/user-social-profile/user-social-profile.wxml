<!--pages/user-social-profile/user-social-profile.wxml-->
<view class="container">
  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>

  <!-- 主要内容 -->
  <view wx:else>
    <!-- 顶部导航栏 -->
    <!-- <view class="top-nav">
      <view class="nav-left">
      </view>
      <view class="nav-title">兜圈圈个人主页</view>
      <view class="nav-right"></view>
    </view> -->

  <!-- 用户信息区域 -->
  <view class="user-info-section">
    <!-- 用户头像 -->
    <view class="user-avatar-container" bindtap="editProfile">
      <view class="user-avatar">
        <image wx:if="{{userInfo.hasCustomAvatar && userInfo.avatar}}" 
               class="user-avatar-image" 
               src="{{userInfo.avatar}}" 
               mode="aspectFill"/>
        <text wx:else class="avatar-text">{{firstWallet && firstWallet.name ? firstWallet.name.charAt(0) : (userInfo.nickname ? userInfo.nickname.charAt(0) : '用')}}</text>
      </view>
    </view>

    <!-- 用户昵称和描述 -->
    <view class="user-details">
      <text class="user-nickname">{{userInfo.nickname}}</text>
      <text class="user-description">{{userInfo.description}}</text>
    </view>

    <!-- 社交统计 -->
    <view class="social-stats">
      <view class="stat-item">
        <text class="stat-number">{{socialStats.followingCount}}</text>
        <text class="stat-label">关注</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{socialStats.fansCount}}</text>
        <text class="stat-label">粉丝</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{socialStats.likesCount}}</text>
        <text class="stat-label">获赞</text>
      </view>
    </view>

  <view class="do_btn">
    <!-- 编辑资料按钮 -->
    <view class="edit-profile-btn" style="margin-right:16rpx" bindtap="editProfile">
      <text class="edit-text">编辑资料</text>
    </view>
    <!-- 退出登录 -->
    <view class="edit-profile-btn" bindtap="handleLogout">
      <text class="edit-text">退出登录</text>
    </view>
  </view>
  </view>

  <!-- 公开的钱兜兜 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">公开的钱兜兜({{publicWallets.length}})</text>
    </view>
    
    <view class="wallet-list">
      <view wx:if="{{publicWallets.length === 0}}" class="empty-state">
        <text class="empty-icon">💼</text>
        <text class="empty-text">还没有公开的钱兜兜</text>
      </view>
      
      <view wx:for="{{publicWallets}}" wx:key="id" 
            class="wallet-card public-wallet" 
            bindtap="onPublicWalletTap" 
            data-wallet-id="{{item.id}}">
        <!-- 钱包背景 -->
        <view class="wallet-bg" style="{{item.backgroundStyle}}">
          <!-- 钱包标题 -->
          <view class="wallet-title">{{item.title}}</view>
          
          <!-- 钱包描述 -->
          <view class="wallet-description">{{item.description}}</view>
          
          <!-- 钱包金额 -->
          <view class="wallet-amount">
            <text class="amount-symbol">¥</text>
            <text class="amount-number">{{item.amount}}</text>
          </view>
          
          <!-- 社交统计 -->
          <view class="wallet-social-stats">
            <view class="social-stat">
              <text class="stat-num">{{item.fansCount}}</text>
              <text class="stat-text">粉丝</text>
            </view>
            <view class="social-stat">
              <text class="stat-num">{{item.likesCount}}</text>
              <text class="stat-text">获赞</text>
            </view>
            <view class="social-stat">
              <text class="stat-num">{{item.viewsCount}}</text>
              <text class="stat-text">访问</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 关注的钱兜兜 -->
  <view wx:if="{{followedWallets.length > 0}}" class="section">
    <view class="section-header">
      <text class="section-title">关注的钱兜兜({{followedWallets.length}})</text>
      <view class="recent-follow" bindtap="viewRecentFollows">
        <text class="recent-text">最近关注</text>
        <view class="arrow-icon"></view>
      </view>
    </view>
    
    <view class="followed-wallet-list">
      <view wx:for="{{followedWallets}}" wx:key="id" 
            class="followed-wallet-card" 
            bindtap="onFollowedWalletTap" 
            data-wallet-id="{{item.id}}">
        <!-- 钱包背景 -->
        <view class="followed-wallet-bg" style="{{item.backgroundStyle}}">
          <!-- 参与人数标签 -->
          <view class="followed-participant-badge">{{item.participantCount}}人</view>
          
          <!-- 钱包标题 -->
          <view class="followed-wallet-title">{{item.title}}</view>
          
          <!-- 钱包金额 -->
          <view class="followed-wallet-amount">
            <text class="followed-amount-symbol">¥</text>
            <text class="followed-amount-number">{{item.amount}}</text>
          </view>
          
          <!-- 粉丝数 -->
          <view class="followed-fans-count">粉丝 {{item.participantCount}}</view>
        </view>
      </view>
    </view>
  </view>
  </view>
</view>
