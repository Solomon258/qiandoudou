# 关注功能测试指南

## 测试场景

### 测试从兜圈圈进入他人钱包的关注功能

## 测试步骤

### 1. 准备测试环境
1. 确保已登录系统
2. 进入首页，切换到"兜圈圈"标签页
3. 确保有可用的他人钱包显示

### 2. 测试界面布局
1. 点击兜圈圈中任意他人钱包卡片
2. **验证布局**：
   - ✅ 总金额卡片位置：不再覆盖背景图统计信息
   - ✅ 关注按钮位置：在背景图右下角
   - ✅ 关注按钮样式：圆角白色背景，"关注"/"已关注"文字
   - ✅ 统计数据显示：粉丝、获赞、浏览数量
   - ✅ 隐藏功能：无推广卡片、无统计过滤按钮

### 3. 测试关注功能流程

#### 3.1 关注操作测试
1. 点击"关注"按钮
2. **预期结果**：
   - 按钮文字变为"已关注"
   - 按钮样式变为半透明黑色背景
   - 粉丝数量 +1
   - 显示"关注成功"提示

#### 3.2 取消关注测试
1. 再次点击"已关注"按钮
2. **预期结果**：
   - 按钮文字变为"关注"
   - 按钮样式恢复白色背景
   - 粉丝数量 -1
   - 显示"取消关注"提示

### 4. 测试关注列表更新

#### 4.1 检查用户社交主页
1. 返回首页
2. 点击顶部导航的用户头像，进入"兜圈圈个人主页"
3. 查看"关注的钱兜兜"列表
4. **预期结果**：
   - 关注列表数量更新：`关注的钱兜兜(X)` 数字增加
   - 新关注的钱包出现在列表中
   - 钱包信息正确显示（名称、金额、背景）

#### 4.2 验证数据持久化
1. 关闭微信开发者工具
2. 重新打开项目
3. 登录后查看用户社交主页
4. **预期结果**：
   - 关注列表仍然保持更新后的状态
   - 数据正确持久化到本地存储

## 数据流验证

### 关注操作数据流
```
点击关注按钮 
→ 更新UI状态（即时反馈）
→ 调用API（或404时使用模拟）
→ 更新粉丝数
→ 保存到本地存储
→ 通知用户社交主页刷新
```

### 本地存储结构
```javascript
// 存储键：'followedWallets'
[
  {
    id: 钱包ID,
    title: "钱包名称",
    amount: "余额",
    participantCount: 参与人数,
    backgroundStyle: "背景样式"
  }
]
```

## 调试方法

### 1. 控制台日志
关注操作时会输出：
```
关注操作失败: Error: 网络错误: 404  // API不可用
API接口暂不可用，使用模拟模式          // 降级处理
已将钱包添加到关注列表: {钱包信息}     // 本地存储
```

### 2. 存储检查
在开发者工具控制台执行：
```javascript
// 查看关注列表
console.log(wx.getStorageSync('followedWallets'))

// 清空关注列表（测试用）
wx.removeStorageSync('followedWallets')
```

### 3. 页面状态检查
在钱包详情页控制台执行：
```javascript
// 查看当前页面状态
console.log('fromSocial:', this.data.fromSocial)
console.log('isOwnWallet:', this.data.isOwnWallet)
console.log('isFollowing:', this.data.isFollowing)
console.log('socialStats:', this.data.socialStats)
```

## 预期测试结果

### ✅ 成功标准
1. 关注按钮位置和样式正确
2. 点击关注后状态正确切换
3. 粉丝数实时更新
4. 用户社交主页关注列表增加
5. 数据持久化正常
6. 404错误时降级处理正常

### ⚠️ 常见问题
1. **404错误**：正常现象，会自动降级到模拟模式
2. **关注列表不更新**：检查本地存储和页面刷新逻辑
3. **按钮样式异常**：检查CSS类名绑定

## 实际测试建议

1. **先测试模拟模式**：在API不可用时验证前端逻辑
2. **后测试真实API**：等后端启动后验证完整流程
3. **多次切换测试**：验证关注/取消关注的状态管理
4. **跨页面测试**：验证用户社交主页的数据同步

---

现在您可以按照这个指南测试关注功能了！即使遇到404错误，功能也会正常工作。
